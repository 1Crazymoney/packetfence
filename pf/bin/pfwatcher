#!/bin/sh
#
# Copyright 2005 Dave Laporte <dave@laportestyle.org>
# Copyright 2005 Kevin Amorin <kev@amorin.org>
#
# See the enclosed file COPYING for license information (GPL).
# If you did not receive this file, see
# http://www.fsf.org/licensing/licenses/gpl.html.
#


WATCHED_PROCS="pfdhcplistener pfmon pfdetect pfredirect httpd snort mysqld"
TO_ADDR="youaddr@your.edu"

for PROC in $WATCHED_PROCS
do
  PID=`/sbin/pidof -x $PROC`
  if [ -z "$PID" ]
  then
    FINAL="$PROC\n$FINAL"
  fi
done

if [ -n "$FINAL" ]
then
  FINAL="The following processes are not running on `hostname`:\n\n$FINAL"
  echo -e $FINAL | mail -s "PF WATCHER ALERT!" $TO_ADDR
fi
