[general.logo]
type=text
description=<<EOT
Logo displayed on web pages.
EOT

[general.domain]
type=text
description=<<EOT
Domain name of PacketFence system.
EOT

[general.caching]
type=toggle
options=enabled|disabled
description=<<EOT
Enable caching of isinternal values. Not recommended on large networks.
Disabled by default.
EOT

[general.dnsservers]
type=text
description=<<EOT
Comma-delimited list of DNS servers.
EOT

[general.hostname]
type=text
description=<<EOT
Hostname of PacketFence system. This is concatenated with the domain
in Apache rewriting rules and therefore must be resolvable by clients.
EOT

[general.dhcpservers]
type=text
description=<<EOT
Comma-delimited list of DHCP servers.
EOT

[general.locale]
type=multi
options=de_DE|en_US|es_ES|fr_FR|it_IT|nl_NL|pt_BR
description=<<EOT
Locale used for message translation
More than 1 can be specified
EOT

[general.maintenance_interval]
type=time
description=<<EOT
Interval at which Packetfence runs its maintenance tasks.
EOT

[arp.cleanshutdown]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, ARPs are sent to all trapped systems to re-point them to
the correct gateway device at shutdown.
EOT

[arp.interval]
type=time
description=<<EOT
Interval at which poisoned ARPs ("traps") are sent to 
infected/unregistered systems.
EOT

[arp.strobe]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, sends ARP request to all IP addresses within range 
immediately after startup.  This allows for the internal MAC 
to IP mappings to be populated quickly.
EOT

[arp.gw_timeout]
type=time
description=<<EOT
Used in detection of systems with statically-defined gateway ARP
entries.  If a system has not ARPed for the gateway within this 
interval, it is removed from the IP->MAC mappings and should be 
flagged as rogue by the next probe.
EOT

[arp.timeout]
type=time
description=<<EOT
Length of time of inactivity after which an unresponsive system is
aged out.  Hello ARPs are sent at timeout/2 and timeout-interval to
avoid prematurely timing out a system.
EOT

[arp.dhcp_timeout]
type=time
description=<<EOT
Used in detection of systems with static IP addresses. Looks for 
broadcast DHCPDISCOVERs and flags a node as rogue if it fails to see
one before timer is exceeded.  This value should be greater than 50%
of your DHCP lease time.
EOT

[arp.listendevice]
type=text
description=<<EOT
Used to specify an alternative interface to use for ARP/DHCP
monitoring.  Useful when a local SPAN is present as monitoring DHCP 
without a SPAN may result in static DHCP false positives (DHCPRENEWs
are unicast).  This option will likely be deprecated in favor of an
"arp" interface type in future versions.
EOT

[arp.heartbeat]
type=time
description=<<EOT
To eliminate the negative effects of switch flooding of poisoned ARPs
on some (cough...cough...Netgear MR814v2) routers, we must first send
a valid ARP to establish that the system is on-line.  The heartbeat is
the length of time between the initial "hello" and a poisoned 
"goodbye".
EOT

[arp.stuffing]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, forces PF system to "stuff" router ARP cache with a bogus
MAC for systems that are not responding.  This option effectively
increases the "stickiness" of traps by suppressing broadcast ARP
traffic from the gateway.  It is also somewhat dangerous in that it
relies on systems to issue a GARP (gratuitous ARP) at boot to reclaim
previously stuffed addresses.
EOT

[network.dhcpdetector]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, PacketFence will monitor DHCP-specific items such as rogue
DHCP services, DHCP-based OS fingerprinting, computername/hostname 
resolution, and (optionnally) option-82 location-based information. 
The monitored DHCP packets are DHCPDISCOVERs and DHCPREQUESTs - both
are broadcasts, meaning a span port is not necessary.  This feature is
highly recommended if the internal network is DHCP-based.
EOT

[network.dhcpoption82logger]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled PacketFence will monitor DHCP option82 location-based
information. This feature is only available if the dhcpdetector is
activated.
EOT

[network.rogueinterval]
type=numeric
description=<<EOT
When rogue DHCP server detection is enabled, this parameter defines
how often to email administrators.  With its default setting of 10, 
it will email administrators the details of the previous 10 DHCP
offers.
EOT

[proxies]
description=<<EOT
This section allows you to configure locally proxied content.  We 
typically use this to proxy tools like Stinger rather than having to
continually download the latest version. Ex:
tools/stinger.exe=http://download.nai.com/products/mcafee-avert/stinger.exe
The Stinger utility could then be accessed at
https://pfhostname/proxies/tools/stinger.exe.
EOT

[services.httpd]
type=text
description=<<EOT
Location of the apache binary.  Only necessary to change if you are
not running the RPMed version.
EOT

[services.dhcpd]
type=text
description=<<EOT
Location of the dhcpd binary.  Only necessary to change if you are not
running the RPMed version.
EOT

[services.named]
type=text
description=<<EOT
Location of the named binary.  Only necessary to change if you are not
running the RPMed version.
EOT

[services.snmptrapd]
type=text
description=<<EOT
Location of the snmptrapd binary.  Only necessary to change if you are
not running the RPMed version. 
EOT

[services.snort]
type=text
description=<<EOT
Location of the snort binary.  Only necessary to change if you are not
running the RPMed version.
EOT

[trapping.testing]
type=toggle
options=enabled|disabled
description=<<EOT
Disables sending of ARPs - note that this has implications on node
detection and timeouts.
EOT

[trapping.redirecturl]
type=text
description=<<EOT
Default URL to redirect to on registration/mitigation release.  This
is only used if a per-violation redirecturl is not defined.
EOT

[trapping.always_use_redirecturl]
type=toggle
options=enabled|disabled
description=<<EOT
Under most circumstances we can redirect the user to the URL he originally 
intended to visit. When enabled, always_use_redirecturl forces the captive 
portal to redirect the user to the URL defined in trapping.redirecturl instead.
EOT

[trapping.detection]
type=toggle
options=enabled|disabled
description=<<EOT
Enables snort-based worm detection.  If you don't have a span
interface available, don't bother enabling it.  If you do, you'll most
definately want this on.
EOT

[trapping.redirtimer]
type=time
description=<<EOT
How long to display the progress bar during trap release.  Setting it
to a value of 5 or higher is recommended when in arp mode.  Doing so
allows the client time to receive and process the redirection ARP sent
by PacketFence.
EOT

[trapping.blacklist]
type=text
description=<<EOT
Comma-delimited list of MAC addresses that are not allowed to pass
through the PacketFence system.
EOT

[trapping.range]
type=text
description=<<EOT
Address ranges/CIDR blocks that PacketFence will monitor/detect/trap
on.  Gateway, network, and broadcast addresses are ignored.
Comma-delimited entires should be of the form
a.b.c.0/24
a.b.c.0-255
a.b.c.0-a.b.c.255
a.b.c.d
EOT

[trapping.whitelist]
type=text
description=<<EOT
Comma-delimited list of MAC addresses that are immune to isolation. 
Additionally, in ARP mode no registration or trapping is performed so whitelisted hosts are always allowed to pass.
EOT

[trapping.passthrough]
type=toggle
options=iptables|proxy|disabled
description=<<EOT
Method by which content is delivered to trapped systems. When set to 
"proxy", PacketFence uses Apache's reverse proxy functionality and 
rewrites links. Note that any link to an external resource on the 
target server will not be properly rewritten. When set to "iptables",
PacketFence creates passthroughs to the content for only those nodes
trapped with the corresponding violation.  Be aware that an iptables
passthrough is based on IP address and clients will be able to get to
ALL content on the destination site.
When set to "disabled" passthrough is disabled.
EOT

[trapping.registration]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, nodes will be required to register on first network
access.  Further registration options are configured in the 
registration section.
EOT

[registration.expire_mode]
type=toggle
options=window|deadline|session|disabled
description=<<EOT
If set to "deadline", the expire_deadline option defines the date at
which a node reverts to an unregistered state.  If set to "window",
the window is used to determine the length of time after registration
that a node remains registered.  If set to "session", it specifies
that a client should be unregistered as soon as its iplog entry closes
(or with a bit of latency - check regitration.expire_session).
EOT

[registration.expire_window]
type=time
description=<<EOT
If expire_mode is set to "window", this is length of time after
registration that a node reverts to an unregistered state.
EOT

[registration.expire_deadline]
type=date
description=<<EOT
If expire_mode is set to "deadline", this is the date (formatted as
returned by the "date" command) at which nodes revert to an
unregistered state.  This would typically be the end of a semester.
EOT

[registration.expire_session]
type=time
description=<<EOT
If expire_mode is set to "session", this is the amount of time after
a node's iplog entry is closed that it reverts to an unregistered
state.
Warning: Does not work in vlan isolation mode!
EOT

[registration.skip_window]
type=time
description=<<EOT
The length of time that a node may skip registration.  For instance,
setting it to 2880 minutes would allow students to skip registration
for two days, giving them time to get a student ID, password, etc.
EOT

[registration.skip_mode]
type=toggle
options=window|deadline|disabled
description=<<EOT
If set to "deadline", the deadline option defines the time at which
skipping registration is no longer an option for clients.  If set to
"window", the window is used to determine the amount of time after 
first network access that a node may skip registration.
EOT

[registration.skip_deadline]
type=date
description=<<EOT
If mode is set to "deadline", this is the date at which the "skip
registration" option is disabled.  Date string is formatted as the
output of the "date" command is.
EOT

[registration.maxnodes]
type=numeric
description=<<EOT
If defined, the maximum number of nodes that can be registered to a
single PID.
EOT

[registration.skip_reminder]
type=time
description=<<EOT
Interval that a user is re-prompted to register after skipping.  For
example, if window=2w and reminder=1d, a user will be allowed to skip
for two weeks but will be re-prompted every day.
EOT

[registration.auth]
type=multi
options=local|ldap|radius|kerberos|preregistered_guests
description=<<EOT
Method or methods by which registering nodes will be authenticated.  
Templates for LDAP, RADIUS, Kerberos, local and guests are available at
<conf_dir>/authentication/. 
If you wish to use a different authentication mechanism, simply create 
a file called <conf_dir>/authentication/<authname>.pm, fill it with
the necessary data, and set auth=<authname>.  The default value, 
local, relies on a local access file in <conf_dir>/user.conf.
EOT

[registration.default_auth]
type=text
description=<<EOT
Authentication method selected as the default in the captive portal 
drop-down. Only useful if you have more than one authentication method
(registration.auth).
EOT

[registration.button_text]
type=text
description=<<EOT
The button text will appear on the registration page submit button
EOT

[registration.nbregpages]
type=numeric
description=<<EOT
The number of registration pages to show to the user. If higher than
1, you'll have to create the pages 
html/captive-portal/templates/register_2.html
...
html/captive-portal/templates/register_<nbregpages>.html
EOT

[passthroughs]
description=<<EOT
This section allows you to create passthroughs to HTML content or 
remote addresses/networks.
With passthrough=proxy under [trapping] it will support domain 
names.
With passthrough=iptables under [trapping] it will support domain 
names and IP ranges. Note that this implementation is unmaintained 
and might not work.
Here's an example:
packetfence=http://www.packetfence.org
The above will allow 80/tcp traffic to the packetfence domain (the
left value is arbitrary). Passthroughs can also take the form of:
test=192.168.100.10/23
which would allow full IP to all 512 destination addresses. 
Unsupported in trapping.passhtrough=proxy.
EOT

[alerting.log]
type=text
description=<<EOT
Log file where "log" actions are sent.
EOT

[alerting.fromaddr]
type=text
description=<<EOT
Email address from which notifications of rogue DHCP servers, 
violations with an action of "email", or any other 
PacketFence-related message are sent.
EOT

[alerting.emailaddr]
type=text
description=<<EOT
Email address to which notifications of rogue DHCP servers, violations
with an action of "email", or any other PacketFence-related message
goes to.
EOT

[alerting.smtpserver]
type=text
description=<<EOT
Server through which to send messages to the above emailaddr.  The
default is localhost - be sure you're running an SMTP host locally if
you don't change it!
EOT

[alerting.subjectprefix]
type=text
description=<<EOT
Subject prefix for email notifications of rogue DHCP servers,
violations with an action of "email", or any other PacketFence-related
message.
EOT

[ports.admin]
type=text
description=<<EOT
Port the administrative interface listens on.
EOT

[ports.listeners]
type=multi
options=imap|pop3
description=<<EOT
Enables "bogus" IMAP and POP servers.  These servers serve only to
deliver a message (POP3) or send an alert (IMAP) to inform the user
that he/she must register before connectivity is allowed.  Content of
the message is found at <conf_dir>/listener.msg
EOT

[interface.gateway]
type=text
description=<<EOT
Gateway of the named interface.
EOT

[interface.ip]
type=text
description=<<EOT
IP adress of the named interface - note that this should mirror the
OS-level configuration but it does not make any OS-level changes.
EOT

[interface.mask]
type=text
description=<<EOT
Network mask of the named interface.
EOT

[interface.type]
type=multi
options=internal|management|managed|monitor|dhcplistener|dhcp-listener
description=<<EOT
Describes "type" of named interface.  Internal describes interfaces
where PacketFence will enforce network access, management (or managed)
interfaces have the administrative GUI running on them, host SNMP trap
receiver and RADIUS server, monitor is the interface that snort listens 
on and dhcp-listener is an interface where the DHCP traffic is coming in 
either via a network SPAN or IP-Helpers configuration.
EOT

[interface.enforcement]
type=toggle
options=vlan|inline
description=<<EOT
Describes the technique PacketFence will use to enforce network access.
VLAN is the out-of-band VLAN-based device isolation requiring integration
in your network environment and inline is a DHCP-based mode where
PacketFence acts as a filtering gateway.
EOT

[expire.iplog]
type=time
description=<<EOT
Time which you would like to keep logs on IP/MAC information 
A value of 0d disables expiration.
example:
iplog=180d
EOT

[expire.locationlog]
type=time
description=<<EOT
Time which you would like to keep logs on location information.
Please note that this table should not become too big since it
could degrade pfsetvlan performance.
A value of 0d disables expiration.
example:
locationlog=180d
EOT

[expire.node]
type=time
description=<<EOT
Time before a node is removed due to inactivity.
A value of 0d disables expiration.
example:
node=90d
EOT

[expire.traplog]
type=time
description=<<EOT
Time which you would like to keep logs on trap information 
A value of 0d disables expiration.
example:
traplog=180d
EOT

[scan.ssl]
type=toggle
options=enabled|disabled
description=<<EOT
enable ssl communication with the nessus server.   
EOT

[scan.pass]
type=text
description=<<EOT
Password to log into nessus server with.
EOT

[scan.user]
type=text
description=<<EOT
Username to log into nessus server with.
EOT

[scan.port]
type=text
description=<<EOT
Port nessus server is running on.
EOT

[scan.registration]
type=toggle
options=enabled|disabled
description=<<EOT
If this option is enabled, the PF system will scan each host after
registration is complete with all nessusids.
EOT

[scan.live_tids]
type=text
description=<<EOT
If a host fails a scan AND the tid is listed in live_tids the
corresponding violation will be added. If the tid is not listed here
the event will be logged only.  This is used to test Nessus plugins
before going live. The tid is the Nessus plugin Id.
EOT

[scan.nessusclient_file]
type=text
description=<<EOT
Name of the NessusClient file; the file format is documented at
http://www.nessus.org/documentation/dot_nessus_file_format.pdf
This file must be found in conf/nessus/
EOT

[scan.nessusclient_policy]
type=test
description=<<EOT
Name of the policy inside the NessusClient file
EOT

[scan.host]
type=text
description=<<EOT
Host the nessus server is running on.  For performance reasons, we
recommend running the nessus server remotely.  A passthrough will be
automagically created.
EOT

[scan.duration]
type=time
description=<<EOT
Approximate duration of a scan. User being scanned on registration are presented
a progress bar for this duration, afterwards the browser refreshes until scan is
complete.
EOT

[database.pass]
type=text
description=<<EOT
Password for the mysql database used by PacketFence.
EOT

[database.db]
type=text
description=<<EOT
Name of the mysql database used by PacketFence.
EOT

[database.user]
type=text
description=<<EOT
Username of the account with access to the mysql database used by
PacketFence.
EOT

[database.port]
type=numeric
description=<<EOT
Port the mysql server is running on.
EOT

[database.host]
type=text
description=<<EOT
Server the mysql server is running on.
EOT

[alerting.admin_netbiosname]
type=text
description=<<EOT
NetBIOS name of administrative workstation to send alerts with
"winpopup" action assigned.
EOT

[alerting.wins_server]
type=text
description=<<EOT
WINS server to  resolve NetBIOS name of administrative workstation to
IP address.
EOT

[registration.range]
type=text
description=<<EOT
Address ranges/CIDR blocks that PF will force registration on.
Gateway, network, and broadcast addresses are ignored. If this is not
defined the trapping.range will be used as the registration range.
Comma-delimiter entries should be of the form:
a.b.c.0/24
a.b.c.0-255
a.b.c.0-a.b.c.255
a.b.c.d
EOT

[vlan.closelocationlogonstop]
type=toggle
options=enabled|disabled
description=<<EOT
Should open locationlog entries be closed when pfsetvlan is
stopped
EOT

[vlan.nbtraphandlerthreads]
type=text
description=<<EOT
Number of trap handler threads pfsetvlan should start
EOT

[vlan.nbtrapparserthreads]
type=text
description=<<EOT
Number of trap parser threads pfsetvlan should start
EOT

[vlan.dhcpd]
type=toggle
options=enabled|disabled
description=<<EOT
Should DHCPd be started ?
EOT

[vlan.named]
type=toggle
options=enabled|disabled
description=<<EOT
Should named be started ?
EOT

[vlan.bounce_duration]
type=time
description=<<EOT
Delay to wait between the shut / no-shut on a port. Some OS need a higher value
than others. Default should be reasonable for almost every OS but is too long 
for the usual proprietary OS.
EOT

[inline.ports_redirect]
type=text
description=<<EOT
Ports to intercept and redirect for trapped and unregistered systems.  Defaults
to 80/tcp (HTTP), 443/tcp (HTTPS). Redirecting 443/tcp (SSL) will work, 
although users might get certificate errors if you didn't install a valid 
certificate or if you don't use DNS (although IP-based certificates supposedly
exist)
Redirecting 53/udp (DNS) seems to have issues and is also not recommended.
We also have experimental IMAP and POP3 listeners which give fake emails 
telling users to open their browsers. Enable them via the ports.listeners 
parameter and add the IMAP (143/tcp) and POP3 (110/tcp) here.
EOT

[inline.portal_redirect]
type=toggle
options=ip|dns
description=<<EOT
How should we refer to the captive portal in inline mode? Using DNS means that 
you need to configure your DNS to point to the PacketFence IP on the inline 
interface but allows you to easily use an SSL certificate for https.
EOT

[servicewatch.email]
type=toggle
options=enabled|disabled
description=<<EOT
Should pfcmd service pf watch send an email when services are not
running
EOT

[servicewatch.restart]
type=toggle
options=enabled|disabled
description=<<EOT
Should pfcmd service pf watch restart PF when services are not running
EOT

[captive_portal.network_detection_ip]
type=text
description=<<EOT
This IP is used as the webserver who hosts the 
common/network-access-detection.gif which is used to detect if network access
was enabled. It cannot be a domain name since it is used in registration or 
quarantine where DNS is blackholed. It is recommended that you allow your users
to reach your packetfence server and put your LAN's PacketFence IP. By default
we will make this reach PacketFence's website as an easy solution.
EOT

[advanced.reevaluate_access_reasons]
type=multi
options=node_modify|manage_register|manage_deregister|manage_vclose|manage_vopen|violation_modify|violation_add|violation_delete
description=<<EOT
After which calls to pfcmd do we have to re-evaluate the state of a node and 
re-assign VLAN or change iptables rules
EOT

[advanced.adjustswitchportvlanscript]
type=text
description=<<EOT
Which script do we have to execute to adjust the switchport VLAN
EOT

