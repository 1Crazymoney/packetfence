[general.logo]
type=text
description=<<EOT
Logo displayed on web pages.
EOT

[general.domain]
type=text
description=<<EOT
Domain name of PacketFence system.
EOT

[general.caching]
type=toggle
options=enabled|disabled
description=<<EOT
Enable caching of isinternal values as well as other fun stuff.  Leave this enabled or suffer the performance consequences.
EOT

[general.dnsservers]
type=text
description=<<EOT
Comma-delimited list of DNS servers.  Passthroughs are created to allow queries to these servers from even "trapped" nodes.
EOT

[general.hostname]
type=text
description=<<EOT
Hostname of PacketFence system.  This is concatenated with the domain in Apache rewriting rules and therefore must be resolvable by clients.
EOT

[general.dhcpservers]
type=text
description=<<EOT
Comma-delimited list of DHCP servers.  Passthroughs are created to allow DHCP transactions from even "trapped" nodes.
EOT

[general.locale]
type=text
description=<<EOT
Locale used for message translation
EOT

[arp.cleanshutdown]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, ARPs are sent to all trapped systems to re-point them to the correct gateway device at shutdown.
EOT

[arp.interval]
type=time
description=<<EOT
Interval at which poisoned ARPs ("traps") are sent to infected/unregistered systems.
EOT

[arp.strobe]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, sends ARP request to all IP addresses within range immediately after startup.  This allows for the internal MAC 
to IP mappings to be populated quickly.
EOT

[arp.gw_timeout]
type=time
description=<<EOT
Used in detection of systems with statically-defined gateway ARP entries.  If a system has not ARPed for the gateway 
within this interval, it is removed from the IP->MAC mappings and should be flagged as rogue by the next probe.
EOT

[arp.timeout]
type=time
description=<<EOT
Length of time of inactivity after which an unresponsive system is aged out.  Hello ARPs are sent at timeout/2 
and timeout-interval to avoid prematurely timing out a system.
EOT

[arp.dhcp_timeout]
type=time
description=<<EOT
Used in detection of systems with static IP addresses.  Looks for broadcast DHCPDISCOVERs and flags a node as rogue if it 
fails to see one before timer is exceeded.  This value should be greater than 50% of your DHCP lease time.
EOT

[arp.listendevice]
type=text
description=<<EOT
Used to specify an alternative interface to use for ARP/DHCP monitoring.  Useful when a local SPAN is present as monitoring
DHCP without a SPAN may result in static DHCP false positives (DHCPRENEWs are unicast).  This option will likely be deprecated
in favor of an "arp" interface type in future versions.
EOT

[arp.heartbeat]
type=time
description=<<EOT
To eliminate the negative effects of switch flooding of poisoned ARPs on some (cough...cough...Netgear MR814v2) routers, we 
must first send a valid ARP to establish that the system is on-line.  The heartbeat is the length of time between the initial
"hello" and a poisoned "goodbye".
EOT

[arp.stuffing]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, forces PF system to "stuff" router ARP cache with a bogus MAC for systems that are not responding.  This 
option effectively increases the "stickiness" of traps by suppressing broadcast ARP traffic from the gateway.  It is also 
somewhat dangerous in that it relies on systems to issue a GARP (gratuitous ARP) at boot to reclaim previously stuffed 
addresses.
EOT

[network.nat]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, NATs outgoing traffic to the external interface IP address.  This setting is only useful in an in-line 
deployment.  Enabling in a passive environment will likely cause network issues for trapped nodes.  Enabling this option 
also forces snort to listen on the internal interface - this could have performance implications in high-throughput 
environments.
EOT

[network.mode]
type=toggle
options=passive|inline|dhcp
description=<<EOT
Defines the mode in which PacketFence will operate.  When deployed in-line, PacketFence acts as a router and requires 
internal and external interfaces to "live" on separate networks.  It's also likely that a static route for the internal 
network will need to be added to the upstream router.  The PacketFence system can act as a DHCP server or relay to 
one or more external servers.

When deployed in passive mode, PacketFence uses ARP manipulation inject itself into the datastream of unregistered or 
trapped nodes.  You can read more about the mechanics of ARP manipulation <a 
href="http://www.packetfence.org/dokuwiki/doku.php?id=faq#what_is_arp_manipulation_aka_poisoning_or_spoofing">here</a>.  Passive deployment has several benefits over an 
inline deployment including elimination of a performance bottleneck and single point of failure.  Its major failing is that 
it's not 100% in catching all traffic - spurious packets can and will occasionaly get through.  In an academic 
environment or environments where in-line devices are frowned upon, this failing is minor in relation to the benefits.
EOT

[network.dhcpdetector]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, PacketFence will monitor DHCP-specific items such as rogue DHCP services, DHCP-based OS fingerprinting, computername/hostname 
resolution, and (optionnally) option-82 location-based information.  The monitored DHCP packets are DHCPDISCOVERs and DHCPREQUESTs - both are broadcasts, 
meaning a span port is not necessary.  This feature is highly recommended if the internal network is DHCP-based.
EOT

[network.dhcpoption82logger]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled PacketFence will monitor DHCP option82 location-based information.
This feature is only available if the dhcpdetector is activated.
EOT

[network.named]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, run a nameserver locally.  Combined with a 53/udp redirection port, this can allow you redirect clients based on 
name resolution versus HTTP interception.  There are several caveats to keep in mind, First, many clients cache DNS 
responses which may interrupt connectivity even after successful registration/remediation.  Second, in practice we've 
noticed issues with the local nameserver refusing to answer queries in some cases - this may be related to 
netfilter connection tracking.

If you're running DHCP locally, though, it may make sense to run a nameserver locally as well rather than defining external 
servers to passthrough.  Not that running either DHCP or DNS on a passive deployed PF system establishes dependencies on it 
that are likely not wanted.
EOT

[network.rogueinterval]
type=numeric
description=<<EOT
When rogue DHCP server detection is enabled, this parameter defines how often to email administrators.  With its default 
setting of 10, it will email administrators the details of the previous 10 DHCP offers.
EOT

[network.vlan]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, VLAN based isolation is used.
EOT

[proxies]
description=<<EOT
This section allows you to configure locally proxied content.  We typically use this to proxy tools like Stinger rather 
than having to continually download the latest version. Ex:

<i>tools/stinger.exe=http://download.nai.com/products/mcafee-avert/stinger.exe</i>

The Stinger utility could then be accessed at https://pfhostname/proxies/tools/stinger.exe.
EOT

[services.pfredirect]
type=text
description=<<EOT
Location of the pfredirect daemon.  The default setting should be fine.
EOT

[services.pfdetect]
type=text
description=<<EOT
Location of the pfdetect daemon.  The default setting should be fine.
EOT

[services.pfmon]
type=text
description=<<EOT
Location of the pfmon daemon.  The default setting should be fine.
EOT

[services.pfdhcplistener]
type=text
description=<<EOT
Location of the pfdhcplistener daemon.  The default setting should be fine.
EOT

[services.pfsetvlan]
type=text
description=<<EOT
Location of the pfsetvlan daemon.  The default setting should be fine.
EOT

[services.httpd]
type=text
description=<<EOT
Location of the apache binary.  Only necessary to change if you are not running the RPMed version.
EOT

[services.named]
type=text
description=<<EOT
Location of the named binary.  Only necessary to change if you are not running the RPMed version. 
EOT

[services.nessusd]
type=text
description=<<EOT
Location of the nessusd binary.  Only necessary if you are running nessusd locally and if you are not running the RPMed version.  
EOT

[services.dhcpd]
type=text
description=<<EOT
Location of the dhcpd binary.  Only necessary to change if you are not running the RPMed version.  DHCP is not supported until PacketFence 1.6
EOT

[services.snmptrapd]
type=text
description=<<EOT
Location of the snmptrapd binary.  Only necessary to change if you are not running the RPMed version. 
EOT

[services.snort]
type=text
description=<<EOT
Location of the snort binary.  Only necessary to change if you are not running the RPMed version.
EOT

[trapping.testing]
type=toggle
options=enabled|disabled
description=<<EOT
Disables sending of ARPs - note that this has implications on node detection and timeouts.
EOT

[trapping.redirecturl]
type=text
description=<<EOT
Default URL to redirect to on registration/mitigation release.  This is only used if a per-violation redirecturl is not 
defined.
EOT

[trapping.redirlocal]
type=toggle
options=enabled|disabled
description=<<EOT
Typically best to leave this disabled unless you are having problems and underst
and why you need this.
EOT

[trapping.immediate]
type=toggle
options=enabled|disabled
description=<<EOT
Enable this if you want to see lots of "IP conflict boxes on Windows systems!  On detection of a violation, a spoofed GARP 
(gratitous ARP) is sent to the offending system.  This causes it to think another system is using its IP address and, under 
Windows 2000, causes it to disable its IP stack.  When the user manages to get the system back on the wire (ipconfig 
/release, reboot, etc) he/she will be assigned an address from the isolation scope.
EOT

[trapping.detection]
type=toggle
options=enabled|disabled
description=<<EOT
Enables snort-based worm detection.  If you don't have a span interface available, don't bother enabling it.  If you do, 
you'll most definately want this on.
EOT

[trapping.redirtimer]
type=time
description=<<EOT
How long to display the progress bar during trap release.  Setting it to a value of 5 or higher is recommended 
when in passive mode.  Doing so allows the client time to receive and process the redirection ARP sent by PacketFence.
EOT

[trapping.blacklist]
type=text
description=<<EOT
Comma-delimited list of MAC addresses that are not allowed to pass through the PacketFence system.
EOT

[trapping.range]
type=text
description=<<EOT
Address ranges/CIDR blocks that PacketFence will monitor/detect/trap on.  Gateway, network, and broadcast addresses are ignored.
Comma-delimited entires should be of the form

a.b.c.0/24
a.b.c.0-255
a.b.c.0-a.b.c.255
a.b.c.d
EOT

[trapping.whitelist]
type=text
description=<<EOT
Comma-delimited list of MAC addresses that are immune to registration/trapping and are always allowed to pass.  Useful for
monitored switches, etc.
EOT

[trapping.passthrough]
type=toggle
options=iptables|proxy
description=<<EOT
Method by which content is delivered to trapped systems.  When set to "proxy", PacketFence uses Apache's reverse proxy 
functionality and the mod_proxy_html module to rewrite links.  Note that links external servers will not be properly 
rewritten.  When set to "iptables", PacketFence creates passthroughs to the content for only those nodes trapped with the
corresponding violation.  Be aware that an iptables passthrough is based on IP address and clients will be able to get to
ALL content on the destination site.
EOT

[trapping.registration]
type=toggle
options=enabled|disabled
description=<<EOT
If enabled, nodes will be required to register on first network access.  Further registration options are configured in the 
registration section.
EOT

[registration.expire_deadline]
type=date
description=<<EOT
If expire_mode is set to "deadline", this is the date (formatted as returned by the "date" command) at which 
nodes revert to an unregistered state.  This would typically be the end of a semester.
EOT

[registration.expire_session]
type=time
description=<<EOT
If expire_mode is set to "session", this is the amount of time after a node's iplog entry is closed that it reverts
to an unregistered state.
EOT

[registration.expire_mode]
type=toggle
options=window|deadline|session|disabled
description=<<EOT
If set to "deadline", the expire_deadline option defines the date at which a node reverts to an unregistered 
state.  If set to "window", the window is used to determine the length of time after registration that a node
remains registered.  If set to "session", it specifies that a client should be unregistered as soon as its iplog
entry closes (or with a bit of latency - check regitration.expire_session).
EOT

[registration.queuesize]
type=numeric
description=<<EOT
Useful for passive deployments on very large networks, this defines the number of nodes that PacketFence 
will simultaneously trap for registration (trappings due to violation always occur).  If set to 0, this queue is disabled. 
EOT

[registration.skip_window]
type=time
description=<<EOT
The length of time that a node may skip registration.  For instance, setting it to 2880 minutes would allow 
students to skip registration for two days, giving them time to get a student ID, password, etc.
EOT

[registration.skip_mode]
type=toggle
options=window|deadline|disabled
description=<<EOT
If set to "deadline", the deadline option defines the time at which skipping registration is no longer 
an option for clients.  If set to "window", the window is used to determine the amount of time after 
first network access that a node may skip registration.
EOT

[registration.skip_deadline]
type=date
description=<<EOT
If mode is set to "deadline", this is the date at which the "skip registration" option is disabled.  Date 
string is formatted as the output of the "date" command is.
EOT

[registration.maxnodes]
type=numeric
description=<<EOT
If defined, the maximum number of nodes that can be registered to a single PID.
EOT

[registration.aup]
type=toggle         
options=enabled|disabled
description=<<EOT
If enabled, users will be required to accept an Acceptable Use Policy before network access is allowed.  Currently, registration                     
must be enabled for the AUP to take effect.  The AUP text is found at: 

/usr/local/pf/html/user/content/violations/aup.php
EOT

[registration.skip_reminder]
type=time
description=<<EOT
Interval  that a user is re-prompted to register after skipping.  For example, if window=2w and reminder=1d, a user will
be allowed to skip for two weeks but will be re-prompted every day.
EOT

[registration.expire_window]
type=time
description=<<EOT
If expire_mode is set to "window", this is length of time after registration that a node reverts to an unregistered state.
EOT

[registration.auth]
type=multi
options=local|ldap|radius
description=<<EOT
Method or Methods by which registering nodes will be authenticated.  Templates for LDAP and local are 
available at /usr/local/pf/conf/authentication/.  If you wish to use a different authentication mechanism, simply create 
a file called /usr/local/pf/conf/authentication/<authname>.pm, fill it with the necessary data, and set 
auth=<authname>.  The default value, local, relies on a local access file in /usr/local/pf/conf/user.conf.
EOT

[registration.button_text]
type=text
description=<<EOT
The button text will appear on the registration page submit button
EOT

[passthroughs]
description=<<EOT
This section allows you to create passthroughs to HTML content or remote addresses/networks.  Here's an example:

<i>packetfence=http://www.packetfence.org</i>

The above will allow 80/tcp traffic to the resolved IP address (the LHS value is arbitrary).  Passthroughs can also take the 
form of:

<i>test=192.168.100.10/23</i>

which would allow full IP to all 512 destination addresses.
EOT

[alerting.log]
type=text
description=<<EOT
Log file where "log" actions are sent.
EOT

[alerting.fromaddr]
type=text
description=<<EOT
Email address from which notifications of rogue DHCP servers, violations with an action of "email", or any other 
PacketFence-related message are sent.
EOT

[alerting.emailaddr]
type=text
description=<<EOT
Email address to which notifications of rogue DHCP servers, violations with an action of "email", or any other 
PacketFence-related message goes to.
EOT

[alerting.smtpserver]
type=text
description=<<EOT
Server through which to send messages to the above emailaddr.  The default is localhost - be sure you're running an SMTP 
host locally if you don't change it!
EOT

[alerting.subjectprefix]
type=text
description=<<EOT
Subject prefix for email notifications of rogue DHCP servers, violations with an action of "email", or any other 
PacketFence-related message.
EOT

[ports.admin]
type=text
description=<<EOT
Port the administrative interface listens on.
EOT


[ports.open]
type=text
description=<<EOT
Ports on the external (world-facing) interface that are open.
EOT

[ports.allowed]
type=text
description=<<EOT
Ports allowed through the PacketFence system regardless of registration or violation status.  It is not necessary to define 
53/udp is DNS servers are defined as passthroughs are automagically added.
EOT

[ports.redirect]
type=text
description=<<EOT
Ports to intercept and redirect for trapped and unregistered systems.  Defaults to 80/tcp (HTTP), 110/tcp (POP3), and 
143/tcp (IMAP).  IMAP and POP3 listeners must be enabled via the listeners parameter if the redirection is to be of any use.  
Redirecting 443/tcp (SSL) will work, although users will get ugly and confusing pop-ups as the commonname will no longer 
match.  Redirecting 53/udp (DNS) seems to have issues and is also not recommended.
EOT

[ports.listeners]
type=multi
options=imap|pop3
description=<<EOT
Enables "bogus" IMAP and POP servers.  These servers serve only to deliver a message (POP3) or send an alert (IMAP) to 
inform the user that he/she must register before connectivity is allowed.  Content of the message is found at 
/usr/local/pf/conf/templates/listener.msg
EOT

[interface.authorizedips]
type=text
description=<<EOT
(Optional) list of IPs/subnets to authorize on this interface. If not specified, all IPs are authorized to connect. This can be used for example to limit access to the management interface to some specific hosts.
EOT

[interface.gateway]
type=text
description=<<EOT
Gateway of the named interface.
EOT

[interface.ip]
type=text
description=<<EOT
IP adress of the named interface - note that this should mirror the OS-level configuration but it does not make any OS-level 
changes.
EOT

[interface.mask]
type=text
description=<<EOT
Network mask of the named interface.
EOT

[interface.type]
type=multi
options=internal|managed|monitor|dhcplistener|isolation|registration
description=<<EOT
Describes "type" of named interface.  Internal describes internal client networks, managed (aka external) interfaces have the administrative 
GUI running on them, monitor is the interface that snort listens on and dhcplistener is an interface connected to a SPAN of the DHCP traffic.
EOT

[routedsubnet.type]
type=multi
options=isolation|registration
description=<<EOT
Describes "type" of named routed subnet.
EOT

[routedsubnet.gateway]
type=text
description=<<EOT
Gateway of the named routed subnet.
EOT

[routedsubnet.mask]
type=text
description=<<EOT
Network mask of the named routed subnet.
EOT

[routedsubnet.network]
type=text
description=<<EOT
Network of the named routed subnet.

[expire.iplog]
type=time
description=<<EOT
Time which you would like to keep logs on IP/MAC information 
EOT

[expire.locationlog]
type=time
description=<<EOT
Time which you would like to keep logs on location information.
Please note that this table should not become too big since it
could degrade pfsetvlan performance.
EOT

[expire.node]
type=time
description=<<EOT
Time before a node is removed due to inactivity.
EOT

[scan.ssl]
type=toggle
options=enabled|disabled
description=<<EOT
enable ssl communication with the nessus server.   
EOT

[scan.pass]
type=text
description=<<EOT
Password to log into nessus server with.
EOT

[scan.user]
type=text
description=<<EOT
Username to log into nessus server with.
EOT

[scan.port]
type=text
description=<<EOT
Port nessus server is running on.
EOT

[scan.registration]
type=toggle
options=enabled|disabled
description=<<EOT
If this option is enabled, the PF system will scan each host after registration is complete with all nessusids.
EOT

[scan.live_tids]
type=text
description=<<EOT
If a host fails a scan AND the tid is listed in live_tids the corresponding violation will
be added.   If the tid is not listed here the event will be logged only.  This is used to test Nessus plugins before going live.
EOT

[scan.host]
type=text
description=<<EOT
Host the nessus server is running on.  For performance reasons, we recommend running the nessus server remotely.  A 
passthrough will be automagically created.
EOT

[database.pass]
type=text
description=<<EOT
Password for the mysql database used by PacketFence.
EOT

[database.db]
type=text
description=<<EOT
Name of the mysql database used by PacketFence.
EOT

[database.user]
type=text
description=<<EOT
Username of the account with access to the mysql database used by PacketFence.
EOT

[database.port]
type=numeric
description=<<EOT
Port the mysql server is running on.
EOT

[database.host]
type=text
description=<<EOT
Server the mysql server is running on.
EOT

[dhcp.registered_lease]
type=text
description=<<EOT
Optional lease time for the registered scope.  If not defined, defaults to 7200 seconds.
EOT

[dhcp.unregistered_lease]
type=text
description=<<EOT
Optional lease time for the unregistered scope.  If not defined, defaults to 120 seconds.
EOT

[dhcp.isolation_lease]
type=text
description=<<EOT
Optional lease time for the isolation scope.  If not defined, defaults to 120 seconds.
EOT

[dhcp.isolation_scopes]
type=text
description=<<EOT
List of scope definitions that isolated clients are assigned to.
EOT

[dhcp.registered_scopes]
type=text
description=<<EOT
List of scope definitions that registered (and non-isolated) clients are assigned to.
EOT

[dhcp.unregistered_scopes]
type=text
description=<<EOT
List of scope definitions that unregistered clients are assigned to.  This is the "default" scope for a new client.
EOT

[scope.network]
type=text
description=<<EOT
Network (in CIDR or prefix notation) of the subnet encompassing the DHCP ranges.
EOT

[scope.gateway]
type=text
description=<<EOT
Network gateway of scope.
EOT

[scope.range]
type=text
description=<<EOT
Address range eligible for DHCP assignment.  A comma-delimited list of networks of the form:

a.b.c.0/24
a.b.c.0-255
a.b.c.0-a.b.c.255
a.b.c.d
EOT

[alerting.admin_netbiosname]
type=text
description=<<EOT
NetBIOS name of administrative workstation to send alerts with "winpopup" action assigned.
EOT

[alerting.wins_server]
type=text
description=<<EOT
WINS server to  resolve NetBIOS name of administrative workstation to IP address.
EOT

[registration.range]
type=text
description=<<EOT
Address ranges/CIDR blocks that PF will force registration on.  Gateway, network, and broadcast addresses are 
ignored. If this is not defined the trapping.range will be used as the registration range.  Comma-delimiter entries
should be of the form:

a.b.c.0/24
a.b.c.0-255
a.b.c.0-a.b.c.255
a.b.c.d
EOT

[vlan.adjustswitchportvlanreasons]
type=multi
options=node_modify|manage_register|manage_deregister|manage_vclose|manage_vopen|violation_modify|violation_add
description=<<EOT
After which calls to pfcmd do we have to re-calculate and re-assign
the switchport VLAN a node is connected to
EOT

[vlan.adjustswitchportvlanscript]
type=text
description=<<EOT
Which script do we have to execute to adjust the switchport VLAN
EOT

[vlan.closelocationlogonstop]
type=toggle
options=enabled|disabled
description=<<EOT
Should open locationlog entries be closed when pfsetvlan is
stopped
EOT

[vlan.nbtraphandlerthreads]
type=text
description=<<EOT
Number of trap handler threads pfsetvlan should start
EOT

[vlan.nbtrapparserthreads]
type=text
description=<<EOT
Number of trap parser threads pfsetvlan should start
EOT

[servicewatch.email]
type=toggle
options=enabled|disabled
description=<<EOT
Should pfcmd service pf watch send an email when services are not running
EOT

[servicewatch.restart]
type=toggle
options=enabled|disabled
description=<<EOT
Should pfcmd service pf watch restart PF when services are not running
EOT

