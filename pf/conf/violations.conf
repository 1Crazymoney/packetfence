# Several of the per-to-peer and worm-related signatures were taken 
# from Emerging Threats (http://www.emergingthreats.net/)
#
# In order to use different rulesets, please point the variable snort_rules,
# defined below (in [defaults]), to your local file(s).
#

[defaults]
priority=4
max_enable=3
actions=email,log
auto_enable=Y
disable=Y
grace=120m
button_text=Enable Network
snort_rules=local.rules,emerging-attack_response.rules,emerging-exploit.rules,emerging-p2p.rules,emerging-scan.rules,emerging-virus.rules

[1100001]
desc=Scan
url=/content/index.php?template=failed_scan
max_enable=4
trigger=Scan::10861,Scan::10943,Scan::11177,Scan::11231,Scan::11302,Scan::11304,Scan::11528,Scan::11595,Scan::11664,Scan::11787,Scan::11790,Scan::11803,Scan::11808,Scan::11835,Scan::11878,Scan::11886,Scan::11887,Scan::11921,Scan::12051,Scan::12052,Scan::12054,Scan::12092,Scan::12208,Scan::12209,Scan::13641,Scan::13852,Scan::14724,Scan::15460,Scan::15894,Scan::15970,Scan::16324,Scan::16326,Scan::16327,Scan::16328,Scan::16329,Scan::18020,Scan::18021,Scan::18023,Scan::18025,Scan::18027,Scan::18028,Scan::18215,Scan::18482,Scan::18483,Scan::18490,Scan::18502,Scan::18681,Scan::18682,Scan::19401,Scan::19402,Scan::19406,Scan::19408,Scan::20005,Scan::20172,Scan::20299,Scan::20368,Scan::20382,Scan::20389,Scan::20390,Scan::20904,Scan::20905,Scan::21213,Scan::21332,Scan::21685,Scan::21687,Scan::22030,Scan::22034,Scan::22183,Scan::22184,Scan::22185,Scan::22186,Scan::22187,Scan::22192,Scan::22194,Scan::22332,Scan::22449,Scan::22530,Scan::23644,Scan::23646,Scan::23647,Scan::23833,Scan::23835,Scan::23837,Scan::23838,Scan::23999,Scan::24000
actions=trap,email,log
disable=N

[1100004]
desc=Ban Ancient OSes
url=/content/index.php?template=banned_os
trigger=OS::16
actions=trap,email,log
disable=Y

[1100005]
desc=Disable NATing Routers and APs
url=/content/index.php?template=nat
trigger=Detect::1100005,Detect::1100006,Detect::1100007,OS::4
actions=trap,email,log
disable=Y

[1100009]
desc=Darknet Access
url=/content/index.php?template=darknet
trigger=Detect::1100009
actions=email,log
disable=Y

[1100010]
desc=Rogue DHCP
url=/content/index.php?template=roguedhcp
actions=email,log
disable=N

#  1200000 - 120099 Reserved for required administration violations

[1200001]
priority=3
desc=System Scan
url=/content/index.php?template=system_scan&admin=yes
actions=trap,log
button_text=Scan
disable=Y

[1200003]
desc=Auto-registered Device
priority=1
trigger=OS::3,OS::6,OS::7,OS::8,OS::10,OS::12,OS::13
actions=log,autoreg
disable=Y

# 1300000 - 1399999 Reserved for PacketFence violations

[1300000]
desc=Generic
priority=8
actions=trap,log
url=/content/index.php?template=generic
disable=N

[1300001]
desc=Spam
priority=6
actions=trap,log
url=/content/index.php?template=spam
disable=N

# 1400000 - 1499999 Reserved for local violations
[1400000]
desc=Hub
actions=trap,email,log
url=/content/index.php?template=hub
disable=N

[2000032]
desc=LSASS Exploit
priority=4
url=/content/index.php?template=lsass
redirect_url=/proxies/tools/stinger.exe
disable=N
trigger=Detect::2000032,Detect::2000033,Detect::2000046,Detect::2001286,Detect::2001337,Detect::2001302

[2002030]
desc=IRC Trojan
priority=3
auto_enable=N
url=/content/index.php?template=trojan
disable=N
trigger=Detect::2002029,Detect::2002030,Detect::2002031,Detect::2002032,Detect::2002033,Detect::2000345,Detect::2000347,Detect::2000348,Detect::2000349,Detect::2000350,Detect::2000351,Detect::2000352
actions=trap,email,log

# The following signatures replace the generic portscan detector.  It was notoriously noisy, expecially
# for BitTorrent clients.  These new signatures look for most of the "worm-like" scanning behaviors.

[2002201]
desc=Zotob (W32.Zotob and variants)
priority=4
url=/content/index.php?template=zotob
disable=N           
trigger=Detect::2002201,Detect::2002203

[2001904]
desc=Telnet Scan
priority=6
url=/content/index.php?template=scanning
disable=N
auto_enable=N
trigger=Detect::2001904

[2001972]
desc=Remote Desktop Scan
priority=6
url=/content/index.php?template=scanning
disable=N
auto_enable=N
trigger=Detect::2001972

[2001569]
desc=NetBIOS Scan
priority=6
url=/content/index.php?template=scanning
disable=N
auto_enable=N
trigger=Detect::2001569,Detect::2001579,Detect::2001580,Detect::2001581,Detect::2001582,Detect::2001583

# The following are peer-to-peer (P2P) signatures.  They can be exceedingly loud, but seem fairly accurate in our experience.
# Since P2P is not considered illicit on all networks, they are all shipped disabled - set disable=N to enable.

[2000334]
desc=P2P (BitTorrent)
priority=8
url=/content/index.php?template=p2p
disable=Y
max_enable=1
trigger=Detect::2000334,Detect::2000357,Detect::2000369

[2001808]
desc=P2P (Limewire)
priority=8
url=/content/index.php?template=p2p
disable=Y
max_enable=1
trigger=Detect::2001808

[2000330]
desc=P2P (eDonkey)
priority=8
url=/content/index.php?template=p2p
disable=Y
max_enable=1
trigger=Detect::2000330,Detect::2000331,Detect::2000332,Detect::2000333,Detect::2001296,Detect::2001297,Detect::2001298,Detect::2001299,Detect::2001305,Detect::2001300

[2001664]
desc=P2P (Gnutella)
priority=8
url=/content/index.php?template=p2p
disable=Y
max_enable=1
trigger=Detect::2001664,Detect::2002760,Detect::2002761

[2001812]
desc=P2P (Kazaa)
priority=8      
url=/content/index.php?template=p2p
disable=Y
max_enable=1
trigger=Detect::2001796,Detect::2001812
