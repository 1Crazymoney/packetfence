server packetfence {

    authorize {
        suffix
        preprocess
        eap {
            ok = return
        }
        files
        expiration
        logintime
        update request {
            FreeRADIUS-Client-IP-Address := "%{Packet-Src-IP-Address}"
        }
        update control {
            Tmp-String-8 = ${soap_server}
            Tmp-String-9 = ${soap_port}
        }
        packetfence
    }

    authenticate {
        Auth-Type MS-CHAP {
            mschap
        }
        eap
    }

    preacct {
        preprocess
        acct_unique
        suffix
        files
    }

    accounting {
        sql
        attr_filter.accounting_response
        update control {
            Tmp-String-8 = ${soap_server}
            Tmp-String-9 = ${soap_port}
        }
        packetfence
    }

    session {
    }

    post-auth {
        exec
        # skip packetfence if we have already treated it in the inner-tunnel
        if (!EAP-Type || (EAP-Type != EAP-TTLS  && EAP-Type != PEAP)) {
            update control {
                Tmp-String-8 = ${soap_server}
                Tmp-String-9 = ${soap_port}
            }
            packetfence
        }
        Post-Auth-Type REJECT {
            attr_filter.access_reject
        }
    }

    pre-proxy {
    }

    post-proxy {
        eap
    }

}
