PKI Quick Installation Guide
===================================
:encoding: UTF-8
:lang: en
:doctype: book

include::includes/global-attributes.asciidoc[]

About this Guide
----------------
This guide has been created to give a quick start to install the Inverse PKI in PacketFence 5+. This guide does not include advanced troubleshooting of EAP-TLS connection. Refer to the documentation of EAP-TLS, RADIUS and OpenSSL for advanced features.

Assumptions
-----------
* You have at least one server with a fresh install of PacketFence 5+
* The server already have a switch with an 802.1X connection working
* RADIUS is fonctionnal for PEAP, EAP-TLS with your own certificate

Installation
------------
Step 1: Install the PKI
~~~~~~~~~~~~~~~~~~~~~~~

NOTE: The packaging of the the PKI is only avialable for Debian at the moment, a CentOS version should come out soon.

Installing 
^^^^^^^^^^

Update the repo list and install the package

Debian:
 # sudo apt-get install packetfence-pki

CentOS:
 # yum install packetfence-pki

Step2: Configuring the PKI
~~~~~~~~~~~~~~~~~~~~~~~~~~

Inverse-PKI Configuration
^^^^^^^^^^^^^^^^^^^^^^^^^

Config Stuff

Packetfence Side:
^^^^^^^^^^^^^^^^^

PKI Side:
^^^^^^^^^

NOTE: The PKI is only listening on 127.0.0.1 which mean you need to have access to the machine

You will first need to log into the PKI:
* Address: https://@server_ip:9191
* Login: admin
* Password: packetfence

After you logged in there is few steps to follow to have the PKI working for an EAP-TLS configuration with Packetfence. You will need to create the following items:
* Certificate of Authority
* Profiles(for each purpose, ie Server/Client auth are 2 different profiles)
* Manual certificate generation


CA blahblah
* Key type, size and digest: we advise to use the following RSA, 2048, sha1
* Basic Constraints: CA:TRUE
* Key Usage and Extended Key Usage can be filled if necessary, more informations about Key Usage and Extended Key Usage here: rfc5280 part 4.2.1.3 and 4.2.1.12
* Days: Number of validity days, ie 3y = 1068

Profile blah blah

Creation of a profile:
* Login: admin
* Password: packetfence
* Crl path: Certification revokation list path.
* Validity: Number of validity days, ie 3y = 1068
* Key type, size and digest: we advise to use the following RSA, 2048, sha1
* Key Usage: 
* Extended Key Usage: Server Certificate Authentication: TLS Web Server Authentication, Client Authentication: TLS Web Client Authentication, more informations about Key Usage and Extended Key Usage here: rfc5280 part 4.2.1.3 and 4.2.1.12
* The P12 mail setup is not mandatory but advise if you need to manually send cert by email.

RADIUS server auth cert blahblah

Generate a certificate from the profile you defined as the server authentication Profile.

Client auth cert blah blah

Generate a certificate from the profile you defined as the client authentication Profile, if you generate this certificate manually you will need to use the 'download cert' or 'send cert' button. When the certificate is generate via Packetfence, the certificate is automaticly integrate into the profile to setup the WiFi network.

Additionnal informations
------------------------

If you need any additional information for the certificate generation we advise to go here: rfc 5280
