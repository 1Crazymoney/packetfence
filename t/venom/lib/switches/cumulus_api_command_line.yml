executor: cumulus_api_command_line
input:
  user: "{{.switch01.api.user}}"
  password: "{{.switch01.api.password}}"
  url: '{{.switch01.api.url}}/nclu/v1/rpc'
  cmd: "show dot1x interface {{.switch01.dot1x_interface.id}} json"
steps:
- type: http
  method: POST
  basic_auth_user: "{{.input.user}}"
  basic_auth_password: "{{.input.password}}"
  url: "{{.input.url}}"
  ignore_verify_ssl: true
  body: >-
    {
      "cmd": "{{.input.cmd}}"
    }
  headers:
    "Content-Type": "application/json"
  assertions:
    - result.statuscode ShouldEqual 200
  output:
    postjson: "{{.result.bodyjson}}"
