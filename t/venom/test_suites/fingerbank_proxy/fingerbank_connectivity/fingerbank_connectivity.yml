name: FingerbankConnectivity
testcases:
- name: Validate the account info through the Fingerbank Perl lib
  steps:

  - type: exec
    script: >
      perl -I/usr/local/pf/lib -I/usr/local/pf/lib_perl/lib/perl5 -Mfingerbank::API -e '($res, $data) = fingerbank::API->new_from_config->account_info; print $res'
    assertions:
      - result.systemout ShouldEqual "200"

- name: Validate the Fingerbank Collector connectivity to the API
  steps:

  - type: http
    method: GET
    url: 'https://127.0.0.1:4723/endpoint_data/001122000001/details'
    ignore_verify_ssl: true
    headers:
      "Authorization": "Token 7eeffe6d2805b5eb69b24cee0a753e17549b95b0"
      "Content-Type": "application/json"
    assertions:
      - result.statuscode ShouldEqual 200
      - result.bodyjson.cloud_api_result.device_name ShouldEqual "Hardware Manufacturer/CIMSYS Inc"


#-A OUTPUT -d 10.0.0.0/8 -j ACCEPT
#-A OUTPUT -d 172.16.0.0/12 -j ACCEPT
#-A OUTPUT -d 192.168.0.0/16 -j ACCEPT
#-A OUTPUT -j DROP
